<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>UrbanMood - Iniciar sesión</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/style.css">
  <style>
    body { min-height:100vh;display:flex;align-items:center;justify-content:center;background:#0d0d0d;margin:0;padding:16px; }
    .login-wrapper { width:100%;max-width:420px;padding:40px 44px;background:#111;border:1px solid #242424;border-radius:18px;box-shadow:0 6px 28px -6px rgba(0,0,0,.55),0 2px 6px -2px rgba(0,0,0,.35);font-family:'Poppins',sans-serif; }
    .login-wrapper h1 { font-size:1.9rem;margin:0 0 2.2rem;color:#c2d03a;text-align:center;font-weight:700;letter-spacing:.5px; }
    .login-wrapper form { display:grid;grid-template-columns:120px 1fr;column-gap:18px;row-gap:22px;align-items:center; }
    .form-row-full { grid-column:1 / -1; }
    .login-wrapper label { font-size:.8rem;text-transform:uppercase;letter-spacing:.08em;color:#d3d7db;font-weight:600;display:block;text-align:right;padding-right:4px; }
    .login-wrapper input { width:100%;padding:13px 15px;border:1px solid #303030;border-radius:10px;background:#181818;color:#f2f2f2;font-size:0.95rem;line-height:1.2; }
    .login-wrapper input:focus { outline:none;border-color:#b6c628;box-shadow:0 0 0 2px rgba(182,198,40,.25); }
    .login-wrapper button { width:100%;background:#b6c628;color:#101410;font-weight:600;border:none;padding:15px 18px;border-radius:12px;cursor:pointer;font-size:1.05rem;transition:.25s;letter-spacing:.5px; }
    .login-wrapper button:hover { background:#cadd32; }
    #form-msg { margin:4px 0 0 0;font-size:.78rem; }
    #form-msg.error { color:#ff6b6b; }
    #form-msg.success { color:#6fdc90; }
    .back-link { display:block;margin-top:26px;text-align:center;font-size:.8rem;color:#889197;text-decoration:none; }
    .back-link:hover { color:#c2d03a; }
    @media (max-width:520px){
      .login-wrapper { padding:34px 26px; }
      .login-wrapper form { grid-template-columns:1fr; }
      .login-wrapper label { text-align:left;padding-right:0;margin-bottom:6px; }
    }
  </style>
</head>
<body>
  <div class="login-wrapper">
    <h1>Iniciar sesión</h1>
    <form id="login-form" method="post" action="/login" novalidate>
      <label for="email">Email</label>
      <div><input id="email" name="email" type="email" autocomplete="username" required></div>
      <label for="password">Contraseña</label>
      <div><input id="password" name="password" type="password" autocomplete="current-password" required minlength="8"></div>
      <div class="form-row-full">
        <button type="submit">Entrar</button>
        <p id="form-msg" class="error" style="display:none"></p>
      </div>
    </form>
    <a class="back-link" href="/forgot-password" style="margin-top:14px;">¿Olvidaste tu contraseña?</a>
    <a class="back-link" href="/">← Volver</a>
  </div>
<script>
  const form = document.getElementById('login-form');
  const msg = document.getElementById('form-msg');
  form.addEventListener('submit', async (e) => {
    msg.style.display = 'none';
    const data = { email: form.email.value.trim().toLowerCase(), password: form.password.value };
    try {
      const res = await fetch('/login', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data) });
      const j = await res.json();
      if(!res.ok || !j.success){
        msg.textContent = j.message || 'Error al iniciar sesión';
        msg.style.display = 'block';
        return;
      }
      const target = j.redirect || '/';
      window.location.replace(target);
    } catch(err){
      msg.textContent = 'Error de red';
      msg.style.display = 'block';
    }
  });
</script>
<noscript style="color:#fff;text-align:center;font-size:.75rem;display:block;margin-top:12px;">Activa JavaScript para iniciar sesión correctamente.</noscript>
</body>
</html>
